<!DOCTYPE html>
<html lang="cn">
    <head>
        <title>Microsoft Office Web Client API</title>
        <link rel="shortcut icon" href="https://kdxiaoyi.github.io/res/ms-office.ico"></link>
        <script>
            function getQueryString(name) {// 正则取参数，典中典
                let reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
                let r = window.location.search.substr(1).match(reg);
                if (r != null) {
                return unescape(r[2]);
                }
                return null;
            }
            function load() {
                // 取参数并尝试打开文件
                var url_src=getQueryString("src")
                console.log ("src参数 = " + url_src)
                var url_src_=encodeURIComponent(url_src)
                console.log ("UrlEncode后src参数 = " + url_src_)
                if (url_src != null){
                    var url_="https://view.officeapps.live.com/op/view.aspx?wdOrigin=BROWSELINK&src="+url_src_
                    document.getElementById("ifr").src = url_
                    console.log ("最终URL = "+url_)
                }
                return
            }
        </script>
        <style>
        *{
            margin: 0;
            padding: 0;
        }
 
        html,body{
            width: 100%;
            height: 100%;
        }
 
        .container{
            width: 100%;
            height: 100%;
        }
        </style>
    </head>
    <body>
        <!-- GUI部分 -->
        <div class = "container"><iframe id="ifr" onclick="url_box_refill()" src="https://view.officeapps.live.com/op/view.aspx?src=https%3A%2F%2Fkdx233.github.io%2Fres%2Fdocs%2Fapi_example%2FERROR.doc&wdOrigin=BROWSELINK" width="99.5%" height="99%">233</iframe></div>

        <!-- 页面逻辑部分 -->
        <script>
        load()
        </script>
    </body>
</html>